<!-- this is a global static patch html file  -->



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->

<!-- Mirrored from zero.digipen.edu/Community/Blogs/Doug/TextEntry.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 28 Dec 2022 00:08:07 GMT -->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Text Entry &mdash; Zero Engine 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Zero Engine 1.0 documentation" href="../../../index-2.html"/>
        <link rel="up" title="Douglas Zwick" href="index.html"/>
        <link rel="next" title="Zero Engine Showcase" href="../../Showcase/index.html"/>
        <link rel="prev" title="Douglas Zwick" href="index.html"/>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','../../../../www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-30697525-2', 'auto');
  ga('send', 'pageview');

</script>



  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index-2.html" class="icon icon-home"> Zero Engine
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="https://zero.digipen.edu/search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference external" href="../../../Launcher/ZeroLauncherSetup.html">Download Zero</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../GettingStarted/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ZeroManual/index.html">Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Community</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../Articles/index.html">Articles</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Blogs</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Douglas Zwick</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Text Entry</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Showcase/index.html">Zero Engine Showcase</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../Workshops/index.html">Classes &amp; Workshops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Support/index.html">Zero Engine Support</a></li>
<li class="toctree-l1"><a class="reference external" href="https://survey.digipen.edu/survey/index/sid/524363/newtest/Y/lang/en">Feedback Survey</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../index-2.html">Zero Engine</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index-2.html">Docs</a> &raquo;</li>
      
          <li><a href="../../index.html">Community</a> &raquo;</li>
      
          <li><a href="../index.html">Blogs</a> &raquo;</li>
      
          <li><a href="index.html">Douglas Zwick</a> &raquo;</li>
      
    <li>Text Entry</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/Community/Blogs/Doug/TextEntry.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="searchtitle section" id="text-entry">
<span id="communityblogdougtextentry"></span><h1>Text Entry</h1>
<div class="line-block">
<div class="line"><em>Doug Zwick</em></div>
<div class="line"><em>Staff Writer</em></div>
<div class="line"><br /></div>
</div>
<div class="rightfloat container">
<div class="stdfigure container">
<p><a class="reference internal" href="../../../_images/MaturityOptional.gif"><img alt="MaturityOptional" src="../../../_images/MaturityOptional.gif" style="width: 208px;" /></a></p>
<p>Maturity is recommended but optional</p>
</div>
</div>
<p class="searchdescription">Okay, so let&#8217;s say you&#8217;re making a video game (I know what you&#8217;re thinking, but
stick with me, my story gets better) and you want the player to be able to type
some text at you, and you&#8217;re gonna do something with it. Maybe it&#8217;s their name,
I don&#8217;t know. Whatever. Now, you&#8217;re gonna need a <strong>text field</strong>, also known as a
&#8220;text box&#8221;, though it needn&#8217;t necessarily appear explicitly as a box.</p>
<p>Zero doesn&#8217;t provide anything like this right out of the box (pun most certainly
intended), but it&#8217;s pretty easy to roll your own. Let&#8217;s figure out how! (I&#8217;ve
never done this before either, so bear with me.)</p>
<div class="section" id="what-you-ll-need">
<h2>What You&#8217;ll Need</h2>
<ul class="simple">
<li><strong>scissors</strong></li>
<li><strong>glue</strong></li>
<li>the <strong>Zero Editor</strong></li>
<li>adult supervision</li>
</ul>
<p>The scissors and glue are a joke, but you should always have adult supervision.</p>
<p>Let&#8217;s talk about what this thing should do.</p>
</div>
<div class="section" id="desired-features">
<h2>Desired Features</h2>
<p>What should our text box be like? What should it do? Let us look to some of the
great text fields of history for inspiration.</p>
<div class="stdfigure container">
<p><a class="reference internal" href="../../../_images/SublimeCommand.gif"><img alt="SublimeCommand" src="../../../_images/SublimeCommand.gif" style="width: 2.39in;" /></a> <a class="reference internal" href="../../../_images/ChromeURLBar.gif"><img alt="ChromeURLBar" src="../../../_images/ChromeURLBar.gif" style="width: 2.39in;" /></a> <a class="reference internal" href="../../../_images/FileSaveDialog.gif"><img alt="FileSaveDialog" src="../../../_images/FileSaveDialog.gif" style="width: 2.39in;" /></a></p>
<p>Ye olde <strong>Sublime Texte Commande Pallete</strong>, ye olde <strong>Google Chrome URL
Barre</strong>, and ye olde <strong>Windowes File Sayve Dialogue Boxe</strong>.</p>
</div>
<p>Our humble text box won&#8217;t have <em>all</em> of the slick features they have, but we can
at least identify a lot of the important ones and make sure to cover them.</p>
<p>First off, you need to be able to type in it. This might mean that you&#8217;ll be
able to <strong>select</strong> it, though we could just say it&#8217;s &#8220;selected&#8221; by default (and
impossible to deselect). The idea here is that when you type, if a text field is
selected, the stuff you type will appear in that field.</p>
<p>You need to be able to make arbitrary text appear in it, and you need to be able
to delete that text. You may want to make it change your cursor when you mouse
over it and stuff too. And you&#8217;ll probably want to have some kind of typing
caret to show where the next character will appear.</p>
<p>Also, it should have some kind of box shape.</p>
<p>So far, it should support the following features:</p>
<div class="admonition-desired-features admonition">
<p class="first admonition-title">Desired Features</p>
<div class="last line-block">
<div class="line">&#x2610;   Typing in it</div>
<div class="line">&#x2610;   (Maybe) Selecting it</div>
<div class="line">&#x2610;   (Maybe) Deselecting it</div>
<div class="line">&#x2610;   Deleting text</div>
<div class="line">&#x2610;   Changing the mouse cursor on mouse over</div>
<div class="line">&#x2610;   Typing caret to show where the next character will appear</div>
<div class="line">&#x2610;   Box shape</div>
</div>
</div>
<p>...Probably lots more, too. We could go on for days. The truth is, a &#8220;simple&#8221;
text field is actually far from simple: it has dozens of features that are very
easy to take for granted when we&#8217;re using it, but are far from trivial when
we&#8217;re making it.</p>
<p>This list is long enough for now. I&#8217;ll add stuff to it as it occurs to me.</p>
</div>
<div class="section" id="getting-started">
<h2>Getting Started</h2>
<p>Let&#8217;s start by making the box. We&#8217;ll keep it simple for now &#8212; we can (and
absolutely will) make it fancier later. Let&#8217;s just start with a sprite for the
background. The editor&#8217;s built-in <code class="docutils literal"><span class="pre">Square</span></code> sprite source will suffice.</p>
<p>I started with an empty 2D project and made a sprite, and named it
<code class="docutils literal"><span class="pre">TextBackground</span></code>. This is going to be the box the text goes in. Text boxes are
generally wider than they are tall, so I gave it an Area component and made it,
oh, 20 units wide:</p>
<p><img alt="TextFieldWhite" src="../../../_images/TextFieldWhite.png" /></p>
<div class="admonition-feature-progress admonition">
<p class="first admonition-title">Feature Progress</p>
<div class="last line-block">
<div class="line">&#x2610;   Typing in it</div>
<div class="line">&#x2610;   (Maybe) Selecting it</div>
<div class="line">&#x2610;   (Maybe) Deselecting it</div>
<div class="line">&#x2610;   Deleting text</div>
<div class="line">&#x2610;   Changing the mouse cursor on mouse over</div>
<div class="line">&#x2610;   Typing caret to show where the next character will appear</div>
<div class="line">&#x2611; Box shape</div>
</div>
</div>
<div class="sidebar">
<p class="first sidebar-title">Colored Borders</p>
<p class="last">If you think I&#8217;m going to be content without the ability to change the color
of the border of the text box from black, well, you&#8217;ve got another think
coming. The problem is that in order to fix this in a satisfying way, we&#8217;re
going to have to make at least one more sprite source, and then we have to
prep it and stuff, and blah blah blah. It&#8217;s enough of a hassle that I&#8217;m going
to defer it to my next blog entry. Stay tuned.</p>
</div>
<p>Next, we need a place for the text to live. I created a sprite text cog, and
named it <code class="docutils literal"><span class="pre">TextString</span></code>. Its size should match the size of the box it&#8217;s
contained in, so I gave it an Area component too, and made its size match that
of the background sprite. I set its text color to black so that it could be
seen against the white of the background sprite. (Don&#8217;t worry, I&#8217;ll change both
colors to something cooler soon.) I set the text to a string from Lorem Ipsum,
and then played with the font size until it was vertically centered nicely. 46
worked well:</p>
<div class="stdfigure container">
<p><a class="reference internal" href="../../../_images/TextWithLoremIpsum.png"><img alt="TextWithLoremIpsum" src="../../../_images/TextWithLoremIpsum.png" style="width: 4in;" /></a></p>
<p><a class="reference external" href="https://www.youtube.com/watch?v=Y4zfkeTsto0">...elit! Elit!</a></p>
</div>
<p>The next thing we&#8217;re going to have to do is to write a component that will
contain all the logic for typing and displaying characters. So, basically, we&#8217;re
going to have one cog with a SpriteText component that holds the text box&#8217;s
text string, and we&#8217;re going to have another cog with a Sprite component that is
the text box&#8217;s rectangular background, and somewhere in all of this, we&#8217;re going
to have a cog that has our typing logic component. How should the hierarchy tree
be organized?</p>
<p>I feel like the actual logic of the typing and receiving text characters and
such should all live in another cog, separate from these two. We&#8217;ll make the
text and the background siblings, and their parent will be the actual text field
cog itself.</p>
<p>Take a look at this whiteboard diagram:</p>
<div class="whiteboard-drawing container">
<a class="reference internal" href="../../../_images/TreeWhiteboard.jpg"><img alt="TreeWhiteboard" src="../../../_images/TreeWhiteboard.jpg" style="width: 8in;" /></a></div>
<p>(Note that we could add any number of features to this text box, many of which
would be additional children of the root.)</p>
<p>I selected the TextString and the TextBackground and hit <code class="docutils literal"><span class="pre">Ctrl</span> <span class="pre">+</span> <span class="pre">G</span></code> to group
them, then renamed their new parent from &#8220;Root&#8221; to <code class="docutils literal"><span class="pre">TextField</span></code>. This I then
uploaded as an archetype of the same name.</p>
<p><img alt="Tree" src="../../../_images/Tree.png" /></p>
<p>Okay, let&#8217;s get cracking with that typing bit, shall we?</p>
</div>
<div class="section" id="typing">
<h2>Typing</h2>
<p>I added a new ZilchScript called <code class="docutils literal"><span class="pre">TextInput</span></code> and added it to the TextField
cog. For now, for the sake of simplicity, we&#8217;re going to assume that the text
field it&#8217;s attached to is always selected. We&#8217;ll get all the selection /
deselection business out of the way later.</p>
<p>Here&#8217;s what I&#8217;m starting with for the TextInput component&#8217;s code:</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="kd">class</span> <span class="nx">TextInput</span> <span class="o">:</span> <span class="nx">ZilchComponent</span>
<span class="p">{</span>
  <span class="p">[</span><span class="nx">Property</span><span class="p">]</span>
<span class="hll">  <span class="k">var</span> <span class="nx">TextCP</span> <span class="o">:</span> <span class="nx">CogPath</span><span class="o">;</span>
</span>  <span class="p">[</span><span class="nx">Property</span><span class="p">]</span>
<span class="hll">  <span class="k">var</span> <span class="nx">BGCP</span> <span class="o">:</span> <span class="nx">CogPath</span><span class="o">;</span>
</span>
<span class="hll">  <span class="k">var</span> <span class="nx">ST</span> <span class="o">:</span> <span class="nx">SpriteText</span><span class="o">;</span>
</span><span class="hll">  <span class="k">var</span> <span class="nx">BG</span> <span class="o">:</span> <span class="nb">Sprite</span><span class="o">;</span>
</span>

  <span class="kd">function</span> <span class="nx">Initialize</span><span class="p">(</span><span class="nx">init</span> <span class="o">:</span> <span class="nx">CogInitializer</span><span class="p">)</span>
  <span class="p">{</span>
<span class="hll">    <span class="k">this</span><span class="p">.</span><span class="nx">ST</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">TextCP</span><span class="p">.</span><span class="nx">Cog</span><span class="p">.</span><span class="nx">SpriteText</span><span class="o">;</span>
</span><span class="hll">    <span class="k">this</span><span class="p">.</span><span class="nx">BG</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">BGCP</span><span class="p">.</span><span class="nx">Cog</span><span class="p">.</span><span class="nb">Sprite</span><span class="o">;</span>
</span>
<span class="hll">    <span class="k">this</span><span class="p">.</span><span class="nx">ClearText</span><span class="p">();</span>
</span>  <span class="p">}</span>


  <span class="kd">function</span> <span class="nx">ClearText</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">ST</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Not much there yet, but I&#8217;ll explain a few things up front:</p>
<ul class="simple">
<li>I&#8217;m using a couple of CogPath properties to give me access to the text and
background cogs. These are probably nothing new to you, but if you need a
review on how they work... well, the lesson doesn&#8217;t exist yet. But it&#8217;s like
high-priority. So it will exist soon. (Cassie, can we get someone on this?)</li>
<li>I&#8217;ve also given myself a couple of non-property members to hold onto a
SpriteText and a Sprite. As you can see, in <code class="docutils literal"><span class="pre">Initialize</span></code>, I&#8217;m setting them
to the SpriteText of the TextString and the Sprite of the TextBackground,
respectively. This is because I want easy access to those components without
going through their owners all the time.<ul>
<li>Effectively, this is kind of like having a <code class="docutils literal"><span class="pre">[Dependency]</span></code> for each, except
that neither is actually attached to the same cog as this component &#8212;
they&#8217;re on its children instead.</li>
</ul>
</li>
<li>Finally, I wrote a function that clears the text, and I&#8217;m calling it in
Initialize. This is so that we can put whatever we like in the text string in
the editor to see what it looks like, and be confident that it will be gone by
the time the project is running.</li>
</ul>
<p>Now, we&#8217;re going to need a function that will add characters to our SpriteText&#8217;s
text string. Each keystroke will potentially add a single character, so I guess
this function should take a string (the character to add):</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">AddText</span><span class="p">(</span><span class="nx">char</span> <span class="o">:</span> <span class="nb">String</span><span class="p">)</span>
<span class="p">{</span>
  <span class="nx">Console</span><span class="p">.</span><span class="nx">WriteLine</span><span class="p">(</span><span class="nx">char</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For now, we&#8217;re just going to print to the console whenever the function is
called, rather than doing anything useful, just for testing purposes.</p>
<p>Now, we need to call this function whenever text is typed, so we&#8217;re going to
connect to an event. You may worry that we&#8217;ll have to connect to the Keyboard&#8217;s
<code class="docutils literal"><span class="pre">KeyDown</span></code> event and write some irritating logic that decides whether the key
that was pressed is actually a text key that we care about and not just like a
function key or Caps Lock or something like that.</p>
<p>Worry not! This irritating logic is already written for you &#8212; we just need to
connect to the <code class="docutils literal"><span class="pre">TextTyped</span></code> event and (most of) our troubles will disappear:</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">Initialize</span><span class="p">(</span><span class="nx">init</span> <span class="o">:</span> <span class="nx">CogInitializer</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">ST</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">TextCP</span><span class="p">.</span><span class="nx">Cog</span><span class="p">.</span><span class="nx">SpriteText</span><span class="o">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">BG</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">BGCP</span><span class="p">.</span><span class="nx">Cog</span><span class="p">.</span><span class="nb">Sprite</span><span class="o">;</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">ClearText</span><span class="p">();</span>

  <span class="nx">Zero</span><span class="p">.</span><span class="nx">Connect</span><span class="p">(</span><span class="nx">Zero</span><span class="p">.</span><span class="nb">Keyboard</span><span class="o">,</span> <span class="nx">Events</span><span class="p">.</span><span class="nx">TextTyped</span><span class="o">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">OnTextTyped</span><span class="p">);</span>
<span class="p">}</span>


<span class="kd">function</span> <span class="nx">OnTextTyped</span><span class="p">(</span><span class="nx">event</span> <span class="o">:</span> <span class="nx">KeyboardTextEvent</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">AddText</span><span class="p">(</span><span class="s2">&quot;Text typed&quot;</span><span class="p">);</span>
<span class="p">}</span>


<span class="kd">function</span> <span class="nx">AddText</span><span class="p">(</span><span class="nx">char</span> <span class="o">:</span> <span class="nb">String</span><span class="p">)</span>
<span class="p">{</span>
  <span class="nx">Console</span><span class="p">.</span><span class="nx">WriteLine</span><span class="p">(</span><span class="nx">char</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>As you can see, we call the <code class="docutils literal"><span class="pre">AddText</span></code> function from <code class="docutils literal"><span class="pre">OnTextTyped</span></code>.
<code class="docutils literal"><span class="pre">AddText</span></code> takes a string, so we pass in a message to tell us that text has
been typed.</p>
<p>Running the project causes, rather unsurprisingly, an error in <code class="docutils literal"><span class="pre">Initialize</span></code>,
because I forgot to hook the cog paths up to the children.</p>
<div class="stdfigure container">
<p><img alt="ErrorMessage" src="../../../_images/ErrorMessage.png" /></p>
<p>How do you like my color scheme?</p>
</div>
<p>I fixed it and updated the TextField archetype:</p>
<p><img alt="TextFieldCogPaths" src="../../../_images/TextFieldCogPaths.png" /></p>
<p>Now when we hit a key, it will print to the console, so long as that key was
something we care about (i.e., a letter or a number, plus the Backspace key and
a couple others).</p>
<p>Console Output:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>---------------- Begin Game ---------------
Level &#39;Level&#39; was loaded.
Loaded level 0.01s
Text typed
Text typed
Text typed
Text typed
</pre></div>
</div>
<div class="section" id="getting-text-in-there">
<h3>Getting Text In There</h3>
<p>Okay, so now we&#8217;re ready to start putting text into the string. Trumpets blare
as we hie excitedly to the <code class="docutils literal"><span class="pre">OnTextTyped</span></code> function.</p>
<p>The <code class="docutils literal"><span class="pre">TextTyped</span></code> event sends a <strong>KeyboardTextEvent</strong>, while our old familiar
<code class="docutils literal"><span class="pre">KeyDown</span></code> event uses the more traditional <strong>KeyboardEvent</strong>. The KeyboardEvent
has a member called <em>Key</em>, of type <code class="docutils literal"><span class="pre">Keys</span></code>, and the KeyboardTextEvent has a
similar member called <em>Character</em>, of type <code class="docutils literal"><span class="pre">Integer</span></code>. <em>Key</em> is a <strong>key code</strong>,
corresponding to the key that was typed. Every key on the keyboard has a key
code, so every key can produce a KeyDown event. <em>Character</em>, on the other hand,
is an <strong>ASCII code</strong>, corresponding to a character of text. Not every key is
mapped to text, so not every key can result in a TextTyped event. Plus, pressing
the Shift key will not trigger TextTyped, but a key that is pressed while
holding it may produce a different <em>Character</em> code than that key alone (as with
capital letters, etc.).</p>
<p>If that was a bit confusing, these whiteboard sketches might help a bit:</p>
<div class="whiteboard-drawing container">
<p><a class="reference internal" href="../../../_images/KEWhiteboard.jpg"><img alt="KEWhiteboard" src="../../../_images/KEWhiteboard.jpg" style="width: 8in;" /></a></p>
<p><a class="reference internal" href="../../../_images/KTEWhiteboard.jpg"><img alt="KTEWhiteboard" src="../../../_images/KTEWhiteboard.jpg" style="width: 8in;" /></a></p>
</div>
<p>So, in order to get the actual character out of the KeyboardTextEvent to add it
to the string, we&#8217;re going to need to use a static method of the String class
called <code class="docutils literal"><span class="pre">FromChar</span></code>, which takes an ASCII code and produces a single-character
string that is the corresponding character.</p>
<p>Let&#8217;s change our <code class="docutils literal"><span class="pre">OnTextTyped</span></code> function accordingly:</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">OnTextTyped</span><span class="p">(</span><span class="nx">event</span> <span class="o">:</span> <span class="nx">KeyboardTextEvent</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">AddText</span><span class="p">(</span><span class="nb">String</span><span class="p">.</span><span class="nx">FromChar</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">Character</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now typing will give us something more useful:</p>
<p>Console Output:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>---------------- Begin Game ---------------
Level &#39;Level&#39; was loaded.
Loaded level 0.00s
a
s

d
f
</pre></div>
</div>
<p>So now all we have to do is append the text we get from the KeyboardTextEvent&#8217;s
Character to the text field&#8217;s string, and we&#8217;ll be making some good progress.</p>
</div>
<div class="section" id="putting-what-you-type-into-the-field">
<h3>Putting What You Type Into the Field</h3>
<p>Making the text field show what the user is typing is as simple as taking
whatever is already in there and sticking what was just typed on the end of it.
Now, if you&#8217;re already familiar with some programming languages, you might
expect to be able to use the <code class="docutils literal"><span class="pre">+</span></code> or <code class="docutils literal"><span class="pre">+=</span></code> operators with strings, but you
can&#8217;t do that in Zilch (for complicated reasons). Instead, you must use one of
two different ways of doing this.</p>
<p>First, Zilch has this thing called a <strong>StringBuilder</strong>. It&#8217;s a class that&#8217;s
designed to concatenate two or more strings into one. You feed it text and it
appends it onto what it already had; when you&#8217;re ready, it can give you the
complete resultant string.</p>
<p>I prefer the second method, which is a neat kind of trick you can do with
<em>string interpolation</em> (remember that from the <span class="xref std std-ref">TutorialScripting</span> lesson?). This
method is a little more compact and, in my opinion, harder to screw up. Let&#8217;s
learn about it!</p>
</div>
<div class="section" id="string-interpolation-revisited">
<h3>String Interpolation, Revisited</h3>
<p>If <code class="docutils literal"><span class="pre">str</span></code> is a variable of type String, then the string <code class="docutils literal"><span class="pre">&quot;`str`&quot;</span></code> is equal to
the value of <code class="docutils literal"><span class="pre">str</span></code> itself, thanks to how string interpolation works.</p>
<p>Consider the following:</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="k">var</span> <span class="nx">str</span> <span class="o">:</span> <span class="nb">String</span> <span class="o">=</span> <span class="s2">&quot;Hello&quot;</span><span class="o">;</span>

<span class="nx">Console</span><span class="p">.</span><span class="nx">WriteLine</span><span class="p">(</span><span class="s2">&quot;Hello&quot;</span><span class="p">);</span>
<span class="nx">Console</span><span class="p">.</span><span class="nx">WriteLine</span><span class="p">(</span><span class="s2">&quot;`str`&quot;</span><span class="p">);</span>
<span class="nx">Console</span><span class="p">.</span><span class="nx">WriteLine</span><span class="p">(</span><span class="nx">str</span><span class="p">);</span>
</pre></div>
</div>
<p>All three <code class="docutils literal"><span class="pre">WriteLine</span></code> calls will produce the same console output:</p>
<p>Console Output:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">Hello</span>
<span class="n">Hello</span>
<span class="n">Hello</span>
</pre></div>
</div>
<p>Makes sense, right? Inside of the &#8220;&#8221; quotes, putting an expression between a
pair of `` marks will cause that expression to be replaced in the string with
the value of that expression itself. In this case, since the expression is a
string, there&#8217;s no difference when we send it to the <code class="docutils literal"><span class="pre">WriteLine</span></code> function.</p>
<p>So now consider this:</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="k">var</span> <span class="nx">str</span> <span class="o">:</span> <span class="nb">String</span> <span class="o">=</span> <span class="s2">&quot;He&quot;</span><span class="o">;</span>

<span class="nx">Console</span><span class="p">.</span><span class="nx">WriteLine</span><span class="p">(</span><span class="s2">&quot;Hello&quot;</span><span class="p">);</span>
<span class="hll"><span class="nx">Console</span><span class="p">.</span><span class="nx">WriteLine</span><span class="p">(</span><span class="s2">&quot;`str`llo&quot;</span><span class="p">);</span>
</span><span class="nx">Console</span><span class="p">.</span><span class="nx">WriteLine</span><span class="p">(</span><span class="nx">str</span><span class="o">,</span> <span class="s2">&quot;llo&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>This shouldn&#8217;t be too surprising either:</p>
<p>Console Output:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">Hello</span>
<span class="n">Hello</span>
<span class="n">He</span><span class="p">,</span> <span class="n">llo</span>
</pre></div>
</div>
<p>That last one looks a little goofy, because of the way that the <code class="docutils literal"><span class="pre">WriteLine</span></code>
function works, but you can see what happened, right? In the call that used
string interpolation, the &#8220;llo&#8221; text got stuck right on the end of the &#8220;He&#8221; text
to produce &#8220;Hello&#8221;.</p>
<p>Let&#8217;s take this one step further:</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="k">var</span> <span class="nx">str</span> <span class="o">:</span> <span class="nb">String</span> <span class="o">=</span> <span class="s2">&quot;He&quot;</span><span class="o">;</span>
<span class="k">var</span> <span class="nx">ing</span> <span class="o">:</span> <span class="nb">String</span> <span class="o">=</span> <span class="s2">&quot;llo&quot;</span><span class="o">;</span>
<span class="hll"><span class="nx">str</span> <span class="o">=</span> <span class="s2">&quot;`str``ing`&quot;</span><span class="o">;</span>
</span>
<span class="nx">Console</span><span class="p">.</span><span class="nx">WriteLine</span><span class="p">(</span><span class="s2">&quot;Hello&quot;</span><span class="p">);</span>
<span class="hll"><span class="nx">Console</span><span class="p">.</span><span class="nx">WriteLine</span><span class="p">(</span><span class="s2">&quot;`str`&quot;</span><span class="p">);</span>
</span><span class="nx">Console</span><span class="p">.</span><span class="nx">WriteLine</span><span class="p">(</span><span class="nx">str</span><span class="p">);</span>
</pre></div>
</div>
<p>Now here&#8217;s where it gets interesting:</p>
<p>Console Output:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">Hello</span>
<span class="n">Hello</span>
<span class="n">Hello</span>
</pre></div>
</div>
<p>We&#8217;ve just appended some characters to the end of our string! We can go even
further with it, to make it more obvious:</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="k">var</span> <span class="nx">str</span> <span class="o">:</span> <span class="nb">String</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">;</span>

<span class="k">var</span> <span class="nx">char0</span> <span class="o">:</span> <span class="nb">String</span> <span class="o">=</span> <span class="s2">&quot;H&quot;</span><span class="o">;</span>
<span class="k">var</span> <span class="nx">char1</span> <span class="o">:</span> <span class="nb">String</span> <span class="o">=</span> <span class="s2">&quot;e&quot;</span><span class="o">;</span>
<span class="k">var</span> <span class="nx">char2</span> <span class="o">:</span> <span class="nb">String</span> <span class="o">=</span> <span class="s2">&quot;l&quot;</span><span class="o">;</span>
<span class="k">var</span> <span class="nx">char3</span> <span class="o">:</span> <span class="nb">String</span> <span class="o">=</span> <span class="s2">&quot;l&quot;</span><span class="o">;</span>
<span class="k">var</span> <span class="nx">char4</span> <span class="o">:</span> <span class="nb">String</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="o">;</span>

<span class="hll"><span class="nx">str</span> <span class="o">=</span> <span class="s2">&quot;`str``char0`&quot;</span><span class="o">;</span>
</span><span class="hll"><span class="nx">str</span> <span class="o">=</span> <span class="s2">&quot;`str``char1`&quot;</span><span class="o">;</span>
</span><span class="hll"><span class="nx">str</span> <span class="o">=</span> <span class="s2">&quot;`str``char2`&quot;</span><span class="o">;</span>
</span><span class="hll"><span class="nx">str</span> <span class="o">=</span> <span class="s2">&quot;`str``char3`&quot;</span><span class="o">;</span>
</span><span class="hll"><span class="nx">str</span> <span class="o">=</span> <span class="s2">&quot;`str``char4`&quot;</span><span class="o">;</span>
</span>
<span class="nx">Console</span><span class="p">.</span><span class="nx">WriteLine</span><span class="p">(</span><span class="s2">&quot;Hello&quot;</span><span class="p">);</span>
<span class="nx">Console</span><span class="p">.</span><span class="nx">WriteLine</span><span class="p">(</span><span class="s2">&quot;`str`&quot;</span><span class="p">);</span>
<span class="nx">Console</span><span class="p">.</span><span class="nx">WriteLine</span><span class="p">(</span><span class="nx">str</span><span class="p">);</span>
</pre></div>
</div>
<p>Console Output:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">Hello</span>
<span class="n">Hello</span>
<span class="n">Hello</span>
</pre></div>
</div>
</div>
<div class="section" id="so">
<h3>So...</h3>
<p>... <strong>it seems that a quick and easy way to add characters to a string is</strong></p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="nx">baseString</span> <span class="o">=</span> <span class="s2">&quot;`baseString``charactersToAdd`&quot;</span><span class="o">;</span>
</pre></div>
</div>
<p>The result will be that <code class="docutils literal"><span class="pre">baseString</span></code> now has all the characters it started
with, plus all the characters of <code class="docutils literal"><span class="pre">charactersToAdd</span></code> stuck on the end of it.</p>
<p>With this handy trick, we can easily append characters to the end of our text
field&#8217;s string. Let&#8217;s use it in our <code class="docutils literal"><span class="pre">AddText</span></code> function:</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">AddText</span><span class="p">(</span><span class="nx">char</span> <span class="o">:</span> <span class="nb">String</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">ST</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="s2">&quot;`this.ST.Text``char`&quot;</span><span class="o">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now, as you type, characters will be added to the string in the game window.</p>
<p><img alt="HelloMyNameIsDoug" src="../../../_images/HelloMyNameIsDoug.png" /></p>
<div class="admonition-feature-progress admonition">
<p class="first admonition-title">Feature Progress</p>
<div class="last line-block">
<div class="line">&#x2611; Typing in it</div>
<div class="line">&#x2610;   (Maybe) Selecting it</div>
<div class="line">&#x2610;   (Maybe) Deselecting it</div>
<div class="line">&#x2610;   Deleting text</div>
<div class="line">&#x2610;   Changing the mouse cursor on mouse over</div>
<div class="line">&#x2610;   Typing caret to show where the next character will appear</div>
<div class="line">&#x2611; Box shape</div>
</div>
</div>
<p>This is great! We&#8217;re well on our way to having a functional text field! Of
course, we can&#8217;t actually correct our mistakes yet, because we still need to
catch the case when the keystroke was the Backspace key, but we&#8217;re getting
there.</p>
</div>
<div class="section" id="keeping-the-wrong-text-out-of-there">
<h3>Keeping the Wrong Text Out of There</h3>
<p>You may have noticed that the Backspace key doesn&#8217;t work properly, but it also
doesn&#8217;t do exactly <em>nothing</em> &#8212; it appears to add a space to our string. In
reality, the Backspace key produces an ASCII code, just like a letter or number.
If you add</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="nx">Console</span><span class="p">.</span><span class="nx">WriteLine</span><span class="p">(</span><span class="nb">String</span><span class="p">.</span><span class="nx">FromChar</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">Character</span><span class="p">));</span>
</pre></div>
</div>
<p>to the <code class="docutils literal"><span class="pre">OnTextTyped</span></code> function, you&#8217;ll see the character that Backspace &#8220;types&#8221;
appearing in the console. In fact, there are a number of keys and key
combinations that will add unwanted characters to our string. (Try <code class="docutils literal"><span class="pre">Ctrl</span></code> +
various keys if you&#8217;re curious, but remember, the editor&#8217;s still running, so
don&#8217;t be surprised if you do something you weren&#8217;t expecting.) What we need is a
way to keep out the stuff we don&#8217;t want while retaining the stuff we do want.</p>
<div class="admonition-feature-progress admonition">
<p class="first admonition-title">Feature Progress</p>
<div class="last line-block">
<div class="line">&#x2611; Typing in it</div>
<div class="line">&#x2610;   <strong>Keeping unwanted characters out of it</strong> <em>(New!)</em></div>
<div class="line">&#x2610;   (Maybe) Selecting it</div>
<div class="line">&#x2610;   (Maybe) Deselecting it</div>
<div class="line">&#x2610;   Deleting text</div>
<div class="line">&#x2610;   Changing the mouse cursor on mouse over</div>
<div class="line">&#x2610;   Typing caret to show where the next character will appear</div>
<div class="line">&#x2611; Box shape</div>
</div>
</div>
<p>To that end, let&#8217;s add another function to our component.</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">IsRenderable</span><span class="p">(</span><span class="nx">code</span> <span class="o">:</span> <span class="nx">Integer</span><span class="p">)</span> <span class="o">:</span> <span class="nb">Boolean</span>
<span class="p">{</span>
  <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">IsRenderable</span></code> function takes a character code and returns a Boolean.
Right now it&#8217;s just always returning <code class="docutils literal"><span class="pre">false</span></code>, but that&#8217;s just so that it will
compile properly. It should return true if the character is something we might
want to type into a text field, and false otherwise. To make that happen, we&#8217;ll
need to know a little bit about ASCII codes.</p>
<p>Every character that gets added to your field&#8217;s string has an ASCII code. It is
this code that tells the computer what each letter is. The string <code class="docutils literal"><span class="pre">Hello,</span>
<span class="pre">World!</span></code>, for instance, looks like this to the computer:</p>
<div class="codetable container">
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">H</th>
<th class="head">e</th>
<th class="head">l</th>
<th class="head">l</th>
<th class="head">o</th>
<th class="head">,</th>
<th class="head">&nbsp;</th>
<th class="head">W</th>
<th class="head">o</th>
<th class="head">r</th>
<th class="head">l</th>
<th class="head">d</th>
<th class="head">!</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0x48</td>
<td>0x65</td>
<td>0x6C</td>
<td>0x6C</td>
<td>0x6F</td>
<td>0x2C</td>
<td>0x20</td>
<td>0x57</td>
<td>0x6F</td>
<td>0x72</td>
<td>0x6C</td>
<td>0x64</td>
<td>0x21</td>
</tr>
</tbody>
</table>
</div>
<div class="sidebar">
<p class="first sidebar-title">The ASCII</p>
<p>Goodness, look at me, prattling on about ASCII codes, and here I haven&#8217;t even
said one word about what the ASCII is! The <strong>A</strong>merican <strong>S</strong>tandard
<strong>C</strong>ode for <strong>I</strong>nformation <strong>I</strong>nterchange is a character-encoding
scheme. It provides a one-to-one mapping of the letters, numbers, and
punctuation used in the English language, as well as a collection of so-called
<strong>control codes</strong>, that are not intended to represent graphical characters.</p>
<p>Following ASCII, alternate encoding schemes arose that could accommodate other
writing systems, including the accented alphabets you see in many European
languages, as well as the vast logographic character sets of East Asia. Some
of these schemes are based closely on the ASCII, and while these writing
systems are not actually supported by the ASCII format, it is not uncommon to
see their character codes referred to as <em>ASCII codes</em> nonetheless.</p>
<p class="last">Admittedly, I&#8217;m being a bit lazy here &#8212; I should probably just be safe and
call them <strong>character codes</strong>, but then I&#8217;d have to go back and rewrite a
bunch of this post, and it&#8217;s probably gonna mess with my line widths.</p>
</div>
<p>Those are the codes for each character in the string on the bottom there, in
hexadecimal. When the computer encounters character code <code class="docutils literal"><span class="pre">48</span></code> in a string, it
renders it as a capital <strong>H</strong>. When it sees a <code class="docutils literal"><span class="pre">6C</span></code>, you get a lowercase <strong>l</strong>,
and so on. In Zilch, you can get the code for any character in a string by
indexing into the string &#8212; try <code class="docutils literal"><span class="pre">Console.WriteLine(&quot;a&quot;[0])</span></code> and see what I
mean.</p>
<p>The way that the ASCII codes are organized, all the non-renderable control
characters come before all the stuff we care about, and all the stuff that
English doesn&#8217;t use comes afterward. Thus, it&#8217;s just a simple matter of checking
the code to see whether it&#8217;s in the renderable range before adding it to the
string. Now, if you&#8217;re like me, you want to be able to use that non-English
stuff, but the engine doesn&#8217;t support it yet, so for now, we&#8217;ll filter it out
with the control characters.</p>
<p>So, we have to know that the first renderable character is the humble <strong>space</strong>,
also known as <code class="docutils literal"><span class="pre">&quot;</span> <span class="pre">&quot;</span></code>, occuring at character position <code class="docutils literal"><span class="pre">32</span></code>, and the last
character in the renderable range is the <em>swung dash</em>, or <strong>tilde</strong>, also known
as <code class="docutils literal"><span class="pre">&quot;~&quot;</span></code>, which occupies spot number <code class="docutils literal"><span class="pre">126</span></code>. Knowing this, we can modify our
<code class="docutils literal"><span class="pre">IsRenderable</span></code> function to filter out unwanted characters.</p>
<p>Now, there&#8217;s two ways to do this. You can either go like</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">IsRenderable</span><span class="p">(</span><span class="nx">code</span> <span class="o">:</span> <span class="nx">Integer</span><span class="p">)</span> <span class="o">:</span> <span class="nb">Boolean</span>
<span class="p">{</span>
  <span class="c1">// magic numbers are bad</span>
  <span class="k">return</span> <span class="nx">code</span> <span class="o">&gt;=</span> <span class="mi">32</span> <span class="o">&amp;&amp;</span> <span class="nx">code</span> <span class="o">&lt;=</span> <span class="mi">126</span><span class="o">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>like a loser, or you can say</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">IsRenderable</span><span class="p">(</span><span class="nx">code</span> <span class="o">:</span> <span class="nx">Integer</span><span class="p">)</span> <span class="o">:</span> <span class="nb">Boolean</span>
<span class="p">{</span>
  <span class="c1">// no magic numbers! huzzah</span>
  <span class="k">return</span> <span class="nx">code</span> <span class="o">&gt;=</span> <span class="s2">&quot; &quot;</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">code</span> <span class="o">&lt;=</span> <span class="s2">&quot;~&quot;</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
  <span class="c1">// ...I mean, 0 doesn&#39;t count as a magic number</span>
<span class="p">}</span>
</pre></div>
</div>
<p>like one of the cool kids. It&#8217;s up to you; I don&#8217;t know whether you&#8217;re a loser
or a cool kid. Anyway, with this new functionality in place, we can make further
changes to the structure of our component. First of all, I want to change what
happens when text is typed. Right now, we&#8217;re just directly adding it to the
string, but what should occur is that when text is typed, we should <em>process the
incoming character code</em>, to make sure it&#8217;s something we care about. Thus, I
propose the following function:</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">ProcessCode</span><span class="p">(</span><span class="nx">code</span> <span class="o">:</span> <span class="nx">Integer</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">IsRenderable</span><span class="p">(</span><span class="nx">code</span><span class="p">))</span>
  <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">AddText</span><span class="p">(</span><span class="nb">String</span><span class="p">.</span><span class="nx">FromChar</span><span class="p">(</span><span class="nx">code</span><span class="p">));</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Then, we&#8217;ll just call the <code class="docutils literal"><span class="pre">ProcessCode</span></code> function from the <code class="docutils literal"><span class="pre">OnTextTyped</span></code>
function:</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">OnTextTyped</span><span class="p">(</span><span class="nx">event</span> <span class="o">:</span> <span class="nx">KeyboardTextEvent</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">ProcessCode</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">Character</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>With these modifications, we still can&#8217;t backspace, but at least we&#8217;re keeping
stuff out of our string that we don&#8217;t want.</p>
<div class="admonition-feature-progress admonition">
<p class="first admonition-title">Feature Progress</p>
<div class="last line-block">
<div class="line">&#x2611; Typing in it</div>
<div class="line">&#x2611; Keeping unwanted characters out of it</div>
<div class="line">&#x2610;   (Maybe) Selecting it</div>
<div class="line">&#x2610;   (Maybe) Deselecting it</div>
<div class="line">&#x2610;   Deleting text</div>
<div class="line">&#x2610;   Changing the mouse cursor on mouse over</div>
<div class="line">&#x2610;   Typing caret to show where the next character will appear</div>
<div class="line">&#x2611; Box shape</div>
</div>
</div>
<p>Now we can move on to getting text out of there.</p>
</div>
</div>
<div class="section" id="getting-text-out-of-there">
<h2>Getting Text Out of There</h2>
<p>So far, we&#8217;ve just been using the <code class="docutils literal"><span class="pre">TextTyped</span></code> event for this component, but
we&#8217;re going to have to do more than that to get all the functionality we want.
For this, we turn to the ol&#8217; <code class="docutils literal"><span class="pre">KeyDown</span></code> event &#8212; perfect for such occasions
&#8212; and its lesser-known cousin, <code class="docutils literal"><span class="pre">KeyRepeated</span></code>. Here&#8217;s my <code class="docutils literal"><span class="pre">Initialize</span></code>
function:</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">Initialize</span><span class="p">(</span><span class="nx">init</span> <span class="o">:</span> <span class="nx">CogInitializer</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">ST</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">TextCP</span><span class="p">.</span><span class="nx">Cog</span><span class="p">.</span><span class="nx">SpriteText</span><span class="o">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">BG</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">BGCP</span><span class="p">.</span><span class="nx">Cog</span><span class="p">.</span><span class="nb">Sprite</span><span class="o">;</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">ClearText</span><span class="p">();</span>

  <span class="nx">Zero</span><span class="p">.</span><span class="nx">Connect</span><span class="p">(</span><span class="nx">Zero</span><span class="p">.</span><span class="nb">Keyboard</span><span class="o">,</span> <span class="nx">Events</span><span class="p">.</span><span class="nx">TextTyped</span><span class="o">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">OnTextTyped</span><span class="p">);</span>
  <span class="nx">Zero</span><span class="p">.</span><span class="nx">Connect</span><span class="p">(</span><span class="nx">Zero</span><span class="p">.</span><span class="nb">Keyboard</span><span class="o">,</span> <span class="nx">Events</span><span class="p">.</span><span class="nx">KeyDown</span><span class="o">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">OnKeyDown</span><span class="p">);</span>
  <span class="nx">Zero</span><span class="p">.</span><span class="nx">Connect</span><span class="p">(</span><span class="nx">Zero</span><span class="p">.</span><span class="nb">Keyboard</span><span class="o">,</span> <span class="nx">Events</span><span class="p">.</span><span class="nx">KeyRepeated</span><span class="o">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">OnKeyDown</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that both <code class="docutils literal"><span class="pre">KeyDown</span></code> and <code class="docutils literal"><span class="pre">KeyRepeated</span></code> are using the same callback
function: they both do the same thing for our purposes, so this works just fine.
Here&#8217;s the <code class="docutils literal"><span class="pre">OnKeyDown</span></code> function:</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">OnKeyDown</span><span class="p">(</span><span class="nx">event</span> <span class="o">:</span> <span class="nb">KeyboardEvent</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">ProcessKey</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nb">Key</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>It calls a <code class="docutils literal"><span class="pre">ProcessKey</span></code> function, paralleling nicely the <code class="docutils literal"><span class="pre">ProcessCode</span></code>
function called by <code class="docutils literal"><span class="pre">OnTextTyped</span></code>. Here&#8217;s that function:</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">ProcessKey</span><span class="p">(</span><span class="nx">key</span> <span class="o">:</span> <span class="nx">Keys</span><span class="p">)</span>
<span class="p">{</span>

<span class="p">}</span>
</pre></div>
</div>
<p>Now we can look at the key code and decide what to do depending on which key it
was. If it&#8217;s the Backspace key, then we can call our cool new <code class="docutils literal"><span class="pre">Backspace</span></code>
function:</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">Backspace</span><span class="p">()</span>
<span class="p">{</span>

<span class="p">}</span>
</pre></div>
</div>
<p>Ultimately, this will remove text from the end of the string. Before we write
that logic, though, let&#8217;s hook it up in <code class="docutils literal"><span class="pre">ProcessKey</span></code>.</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">ProcessKey</span><span class="p">(</span><span class="nx">key</span> <span class="o">:</span> <span class="nx">Keys</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">key</span> <span class="o">==</span> <span class="nx">Keys</span><span class="p">.</span><span class="nx">Back</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">Backspace</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Please don&#8217;t ask why the Backspace key is called</em> <code class="docutils literal"><span class="pre">Back</span></code> <em>in the Keys enum
because I do not know the answer.</em></p>
<p>Pretty straightforward, right?</p>
<p>Okay, so now let&#8217;s get the <code class="docutils literal"><span class="pre">Backspace</span></code> function to actually do something. In
order to remove a character from the end of the string, we need to <strong>replace the
string with itself, minus the last character</strong>. We can do that by taking a
<strong>substring</strong> of the full thing. The String class has a method called
<code class="docutils literal"><span class="pre">SubString</span></code> &#8212; given a string <code class="docutils literal"><span class="pre">str</span></code>, the <code class="docutils literal"><span class="pre">SubString</span></code> method will return a
specified range of characters from the interior of <code class="docutils literal"><span class="pre">str</span></code>. Its syntax is as
follows:</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="nb">String</span><span class="p">.</span><span class="nx">SubString</span><span class="p">(</span><span class="nx">start</span> <span class="o">:</span> <span class="nx">Integer</span><span class="o">,</span> <span class="nx">length</span> <span class="o">:</span> <span class="nx">Integer</span><span class="p">)</span> <span class="o">:</span> <span class="nb">String</span>
</pre></div>
</div>
<p>...where <code class="docutils literal"><span class="pre">start</span></code> is the index of the character from which to start the
substring, and <code class="docutils literal"><span class="pre">length</span></code> is the length of the desired substring. Since we want
the whole string minus the very end, our <code class="docutils literal"><span class="pre">start</span></code> will be <code class="docutils literal"><span class="pre">0</span></code>, the index of
the first character in the string, and our <code class="docutils literal"><span class="pre">length</span></code> will be one shy of the
length of the entire string.</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">Backspace</span><span class="p">()</span>
<span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">ST</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">ST</span><span class="p">.</span><span class="nx">Text</span><span class="p">.</span><span class="nx">SubString</span><span class="p">(</span><span class="mi">0</span><span class="o">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">ST</span><span class="p">.</span><span class="nx">Text</span><span class="p">.</span><span class="nx">Count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This works fine, as you can see if you run it, though it does give us some grief
if we try to backspace when there&#8217;s nothing to delete. All we have to do to get
around that is check whether the string has any characters in it to begin with
before we delete anything:</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">Backspace</span><span class="p">()</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">ST</span><span class="p">.</span><span class="nx">Text</span><span class="p">.</span><span class="nx">Count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">ST</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">ST</span><span class="p">.</span><span class="nx">Text</span><span class="p">.</span><span class="nx">SubString</span><span class="p">(</span><span class="mi">0</span><span class="o">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">ST</span><span class="p">.</span><span class="nx">Text</span><span class="p">.</span><span class="nx">Count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>That&#8217;s nice, but I&#8217;m using <code class="docutils literal"><span class="pre">this.ST.Text.Count</span></code> a bit excessively, so let&#8217;s
store it in a local variable.</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">Backspace</span><span class="p">()</span>
<span class="p">{</span>
  <span class="k">var</span> <span class="nx">length</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">ST</span><span class="p">.</span><span class="nx">Text</span><span class="p">.</span><span class="nx">Count</span><span class="o">;</span>

  <span class="k">if</span><span class="p">(</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">ST</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">ST</span><span class="p">.</span><span class="nx">Text</span><span class="p">.</span><span class="nx">SubString</span><span class="p">(</span><span class="mi">0</span><span class="o">,</span> <span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now we&#8217;re talking. Go ahead and run the project, and you&#8217;ll see that it works
just about perfectly.</p>
<p><img alt="ConstantSorrow" src="../../../_images/ConstantSorrow.gif" /></p>
<div class="admonition-feature-progress admonition">
<p class="first admonition-title">Feature Progress</p>
<div class="last line-block">
<div class="line">&#x2611; Typing in it</div>
<div class="line">&#x2611; Keeping unwanted characters out of it</div>
<div class="line">&#x2610;   (Maybe) Selecting it</div>
<div class="line">&#x2610;   (Maybe) Deselecting it</div>
<div class="line">&#x2611; Deleting text</div>
<div class="line">&#x2610;   Changing the mouse cursor on mouse over</div>
<div class="line">&#x2610;   Typing caret to show where the next character will appear</div>
<div class="line">&#x2611; Box shape</div>
</div>
</div>
<p>Let&#8217;s make that <code class="docutils literal"><span class="pre">ClearText</span></code> function we have lying around useful by expanding
the <code class="docutils literal"><span class="pre">ProcessKey</span></code> function a bit. I say we make it so that the Backspace key
will call it if you press it while holding Control and Shift. Does that sound
alright?</p>
<div class="admonition-feature-progress admonition">
<p class="first admonition-title">Feature Progress</p>
<div class="last line-block">
<div class="line">&#x2611; Typing in it</div>
<div class="line">&#x2611; Keeping unwanted characters out of it</div>
<div class="line">&#x2610;   (Maybe) Selecting it</div>
<div class="line">&#x2610;   (Maybe) Deselecting it</div>
<div class="line">&#x2611; Deleting text</div>
<div class="line">&#x2610;   <strong>Clearing the whole line at once</strong> <em>(New!)</em></div>
<div class="line">&#x2610;   Changing the mouse cursor on mouse over</div>
<div class="line">&#x2610;   Typing caret to show where the next character will appear</div>
<div class="line">&#x2611; Box shape</div>
</div>
</div>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">ProcessKey</span><span class="p">(</span><span class="nx">key</span> <span class="o">:</span> <span class="nx">Keys</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">key</span> <span class="o">==</span> <span class="nx">Keys</span><span class="p">.</span><span class="nx">Back</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">Zero</span><span class="p">.</span><span class="nb">Keyboard</span><span class="p">.</span><span class="nx">KeyIsDown</span><span class="p">(</span><span class="nx">Keys</span><span class="p">.</span><span class="nx">Control</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
       <span class="nx">Zero</span><span class="p">.</span><span class="nb">Keyboard</span><span class="p">.</span><span class="nx">KeyIsDown</span><span class="p">(</span><span class="nx">Keys</span><span class="p">.</span><span class="nx">Shift</span><span class="p">))</span>
    <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">ClearText</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">Backspace</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Does that look reasonable? When you press Backspace, you delete a character from
the end of the string, unless you&#8217;re also holding Control and Shift, in which
case you clear the whole thing. Cool.</p>
<div class="admonition-feature-progress admonition">
<p class="first admonition-title">Feature Progress</p>
<div class="last line-block">
<div class="line">&#x2611; Typing in it</div>
<div class="line">&#x2611; Keeping unwanted characters out of it</div>
<div class="line">&#x2610;   (Maybe) Selecting it</div>
<div class="line">&#x2610;   (Maybe) Deselecting it</div>
<div class="line">&#x2611; Deleting text</div>
<div class="line">&#x2611; Clearing the whole line at once</div>
<div class="line">&#x2610;   Changing the mouse cursor on mouse over</div>
<div class="line">&#x2610;   Typing caret to show where the next character will appear</div>
<div class="line">&#x2611; Box shape</div>
</div>
</div>
<p>This is going great! Let&#8217;s keep adding more and more! That&#8217;s what my heart is
telling me, but my brain is saying, no, this blog entry is too long already; we
can do a Part II later. For now, let&#8217;s add in just one more thing and then we
can wrap it up and go home, okay? It&#8217;s getting late and they only give me so
many hours per week.</p>
</div>
<div class="section" id="just-one-more-thing">
<h2>Just One More Thing</h2>
<p>This wouldn&#8217;t be a Doug Zwick ZE project without a <strong>custom event</strong> of some
kind! See, the utility of a text field is held back a bit when the text just
sits there. It would be better if we could somehow tell the world, &#8220;hey, world,
I just submitted some text!&#8221;, and maybe somebody cares about that? That&#8217;s what I
think.</p>
<div class="admonition-feature-progress admonition">
<p class="first admonition-title">Feature Progress</p>
<div class="last line-block">
<div class="line">&#x2611; Typing in it</div>
<div class="line">&#x2611; Keeping unwanted characters out of it</div>
<div class="line">&#x2610;   <strong>Submitting the text</strong> <em>(New!)</em></div>
<div class="line">&#x2610;   (Maybe) Selecting it</div>
<div class="line">&#x2610;   (Maybe) Deselecting it</div>
<div class="line">&#x2611; Deleting text</div>
<div class="line">&#x2611; Clearing the whole line at once</div>
<div class="line">&#x2610;   Changing the mouse cursor on mouse over</div>
<div class="line">&#x2610;   Typing caret to show where the next character will appear</div>
<div class="line">&#x2611; Box shape</div>
</div>
</div>
<div class="section" id="submitting">
<h3>Submitting</h3>
<div class="sidebar">
<p class="first sidebar-title">Naming Custom Events</p>
<p class="last">So I&#8217;m calling this new event <strong>TextSubmitted</strong>, right? And I&#8217;m making its
custom event class and calling it <strong>TextFieldEvent</strong>. Why not call it
<strong>TextSubmittedEvent</strong>? Well, consider the old beloved <strong>CollisionEvent</strong>: it
is sent out with <code class="docutils literal"><span class="pre">CollisionStarted</span></code>, <code class="docutils literal"><span class="pre">CollisionPersisted</span></code>, and
<code class="docutils literal"><span class="pre">CollisionEnded</span></code>. Three different events all use the same class. In my case,
it doesn&#8217;t seem too farfetched that this component might end up sending out
more than just one event, and rather than making a new custom class for each
one, I&#8217;ll make a single class, and any future events that I hypothetically
decide to create can use it too.</p>
</div>
<p>This romantic notion led me to add the <code class="docutils literal"><span class="pre">TextSubmitted</span></code> event, and its
associated <code class="docutils literal"><span class="pre">TextFieldEvent</span></code> class, to my project. As with any custom event
class, you can feel free to add it to any script in your project, but it
generally makes the most sense to add it to the file that defines the component
that primarily dispatches it.</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="kd">class</span> <span class="nx">TextFieldEvent</span> <span class="o">:</span> <span class="nx">ZilchEvent</span>
<span class="p">{</span>
  <span class="k">var</span> <span class="nx">Field</span> <span class="o">:</span> <span class="nx">TextInput</span><span class="o">;</span>
  <span class="k">var</span> <span class="nx">Text</span> <span class="o">:</span> <span class="nb">String</span><span class="o">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>And, of course, we&#8217;ll add it to the Events object by adding this sweet little
line of code to our TextInput script:</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="kd">class</span> <span class="nx">TextInput</span> <span class="o">:</span> <span class="nx">ZilchComponent</span>
<span class="p">{</span>
<span class="hll">  <span class="nx">sends</span> <span class="nx">TextSubmitted</span> <span class="o">:</span> <span class="nx">TextFieldEvent</span><span class="o">;</span>
</span>
  <span class="p">.</span>
  <span class="p">.</span>
  <span class="p">.</span>
</pre></div>
</div>
<p>This, of course, makes it so that when you type <code class="docutils literal"><span class="pre">Events</span></code> and then a period,
you&#8217;ll see <code class="docutils literal"><span class="pre">TextSubmitted</span></code> among the events listed in the code completion
pane.</p>
<p>Okay, this is going to be fairly straightforward: the event object will store
the TextInput component of the text field cog, and the text in its string at the
moment of dispatching. Now let&#8217;s write a function that will send it out.</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">Submit</span><span class="p">()</span>
<span class="p">{</span>
  <span class="k">var</span> <span class="nx">teEvent</span> <span class="o">=</span> <span class="nx">TextFieldEvent</span><span class="p">();</span>
  <span class="nx">teEvent</span><span class="p">.</span><span class="nx">Field</span> <span class="o">=</span> <span class="k">this</span><span class="o">;</span>
  <span class="nx">teEvent</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">ST</span><span class="p">.</span><span class="nx">Text</span><span class="o">;</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">Space</span><span class="p">.</span><span class="nx">DispatchEvent</span><span class="p">(</span><span class="nx">Events</span><span class="p">.</span><span class="nx">TextSubmitted</span><span class="o">,</span> <span class="nx">teEvent</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is the part where we have to decide how we want to proceed. See, the way
I&#8217;ve written this function, when we submit text, the whole world knows about it,
and anyone who&#8217;s listening to <code class="docutils literal"><span class="pre">TextSubmitted</span></code> on the Space will get all such
events from every text field in that Space. This may be a bit more than what we
actually want. It would be better if the text had a specific place to go: a
<strong>receiver</strong>, if you will. (We can still dispatch to the Space too, just in case
we want to make something that will receive all <code class="docutils literal"><span class="pre">TextSubmitted</span></code> events, like
an output log or something.)</p>
<p>So let&#8217;s add CogPath to our component:</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="p">[</span><span class="nx">Property</span><span class="p">]</span>
<span class="k">var</span> <span class="nx">Receiver</span> <span class="o">:</span> <span class="nx">CogPath</span><span class="o">;</span>
</pre></div>
</div>
<p>And now we&#8217;ll modify our <code class="docutils literal"><span class="pre">Submit</span></code> function to send directly to the receiver,
if it exists:</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">Submit</span><span class="p">()</span>
<span class="p">{</span>
  <span class="k">var</span> <span class="nx">teEvent</span> <span class="o">=</span> <span class="nx">TextFieldEvent</span><span class="p">();</span>
  <span class="nx">teEvent</span><span class="p">.</span><span class="nx">Field</span> <span class="o">=</span> <span class="k">this</span><span class="o">;</span>
  <span class="nx">teEvent</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">ST</span><span class="p">.</span><span class="nx">Text</span><span class="o">;</span>

<span class="hll">  <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">Receiver</span><span class="p">.</span><span class="nx">Cog</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span>
</span><span class="hll">  <span class="p">{</span>
</span><span class="hll">    <span class="k">this</span><span class="p">.</span><span class="nx">Receiver</span><span class="p">.</span><span class="nx">Cog</span><span class="p">.</span><span class="nx">DispatchEvent</span><span class="p">(</span><span class="nx">Events</span><span class="p">.</span><span class="nx">TextSubmitted</span><span class="o">,</span> <span class="nx">teEvent</span><span class="p">);</span>
</span><span class="hll">  <span class="p">}</span>
</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">Space</span><span class="p">.</span><span class="nx">DispatchEvent</span><span class="p">(</span><span class="nx">Events</span><span class="p">.</span><span class="nx">TextSubmitted</span><span class="o">,</span> <span class="nx">teEvent</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Lookin&#8217; good, <code class="docutils literal"><span class="pre">Submit</span></code> function. Now we&#8217;ll just make something call it.
<code class="docutils literal"><span class="pre">ProcessKey</span></code>, you&#8217;re up.</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">ProcessKey</span><span class="p">(</span><span class="nx">key</span> <span class="o">:</span> <span class="nx">Keys</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">key</span> <span class="o">==</span> <span class="nx">Keys</span><span class="p">.</span><span class="nx">Back</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">Zero</span><span class="p">.</span><span class="nb">Keyboard</span><span class="p">.</span><span class="nx">KeyIsDown</span><span class="p">(</span><span class="nx">Keys</span><span class="p">.</span><span class="nx">Control</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
       <span class="nx">Zero</span><span class="p">.</span><span class="nb">Keyboard</span><span class="p">.</span><span class="nx">KeyIsDown</span><span class="p">(</span><span class="nx">Keys</span><span class="p">.</span><span class="nx">Shift</span><span class="p">))</span>
    <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">ClearText</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">Backspace</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="hll">  <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">key</span> <span class="o">==</span> <span class="nx">Keys</span><span class="p">.</span><span class="nx">Enter</span><span class="p">)</span>
</span><span class="hll">  <span class="p">{</span>
</span><span class="hll">    <span class="k">this</span><span class="p">.</span><span class="nx">Submit</span><span class="p">();</span>
</span><span class="hll">  <span class="p">}</span>
</span><span class="p">}</span>
</pre></div>
</div>
<p>Okay. At this point, we can type text and submit it, but nothing&#8217;s receiving it,
so we can&#8217;t tell. Let&#8217;s throw in a simple receiver of some kind, just to show
our friends that we know what we&#8217;re doing. Then we can knock off and head to the
Raven. Sound good? Let&#8217;s do it.</p>
</div>
<div class="section" id="receiving">
<h3>Receiving</h3>
<p>Here&#8217;s a new component for us: the <strong>TextEcho</strong> component. It just receives text
from the <code class="docutils literal"><span class="pre">TextSubmitted</span></code> event and sets its SpriteText component to display
it.</p>
<div class="highlight-as"><div class="highlight"><pre><span></span><span class="kd">class</span> <span class="nx">TextEcho</span> <span class="o">:</span> <span class="nx">ZilchComponent</span>
<span class="p">{</span>
  <span class="p">[</span><span class="nx">Dependency</span><span class="p">]</span>
  <span class="k">var</span> <span class="nx">ST</span> <span class="o">:</span> <span class="nx">SpriteText</span><span class="o">;</span>


  <span class="kd">function</span> <span class="nx">Initialize</span><span class="p">(</span><span class="nx">init</span> <span class="o">:</span> <span class="nx">CogInitializer</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="nx">Zero</span><span class="p">.</span><span class="nx">Connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">Owner</span><span class="o">,</span> <span class="nx">Events</span><span class="p">.</span><span class="nx">TextSubmitted</span><span class="o">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">OnTextSubmitted</span><span class="p">);</span>
  <span class="p">}</span>


  <span class="kd">function</span> <span class="nx">OnTextSubmitted</span><span class="p">(</span><span class="nx">event</span> <span class="o">:</span> <span class="nx">TextFieldEvent</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">ShowText</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">Text</span><span class="p">);</span>
  <span class="p">}</span>


  <span class="kd">function</span> <span class="nx">ShowText</span><span class="p">(</span><span class="nx">text</span> <span class="o">:</span> <span class="nb">String</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">ST</span><span class="p">.</span><span class="nx">Text</span> <span class="o">=</span> <span class="nx">text</span><span class="o">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Simple as can be. I&#8217;ve made a sprite text cog and called it <code class="docutils literal"><span class="pre">EchoReceiver</span></code>,
and thrown the TextEcho component on it. Then I hooked the <strong>Receiver</strong> CogPath
of the TextInput component of our text field up to it, and we&#8217;re ready to roll.</p>
<p><img alt="GoodEnoughForVideoGames" src="../../../_images/GoodEnoughForVideoGames.gif" /></p>
<div class="admonition-feature-progress admonition">
<p class="first admonition-title">Feature Progress</p>
<div class="last line-block">
<div class="line">&#x2611; Typing in it</div>
<div class="line">&#x2611; Keeping unwanted characters out of it</div>
<div class="line">&#x2611; Submitting the text</div>
<div class="line">&#x2610;   (Maybe) Selecting it</div>
<div class="line">&#x2610;   (Maybe) Deselecting it</div>
<div class="line">&#x2611; Deleting text</div>
<div class="line">&#x2611; Clearing the whole line at once</div>
<div class="line">&#x2610;   Changing the mouse cursor on mouse over</div>
<div class="line">&#x2610;   Typing caret to show where the next character will appear</div>
<div class="line">&#x2611; Box shape</div>
</div>
</div>
<p>Okay, we&#8217;ll call it quits for now. We can tackle more of this list next time.
Thanks for reading, etc.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../Showcase/index.html" class="btn btn-neutral float-right" title="Zero Engine Showcase" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Douglas Zwick" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, DigiPen Institute of Technology.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org/">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../../../cdn.mathjax.org/mathjax/latest/MathJaxdda6.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
<script src="../../../_static/js/extjquery.js"></script>



</body>

<!-- Mirrored from zero.digipen.edu/Community/Blogs/Doug/TextEntry.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 28 Dec 2022 00:09:16 GMT -->
</html>